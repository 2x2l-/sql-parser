SELECT DISTINCT MAX(X), (Y || Y) AS YY FROM T WHERE ((Z > 3.14) AND (NOT (W IS NULL))) OR (Y LIKE 'f%') GROUP BY YY HAVING YY > 'z' ORDER BY YYO NULLS FIRST